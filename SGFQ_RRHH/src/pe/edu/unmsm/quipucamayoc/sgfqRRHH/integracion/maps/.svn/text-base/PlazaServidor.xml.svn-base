<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="PuestoTrabajador" >
<typeAlias alias="PlazaServidorDTO" type="pe.edu.unmsm.quipucamayoc.sgfqRRHH.negocio.dto.PlazaServidorDTO"/>

		<resultMap class="PlazaServidorDTO" id="rsPlazaServ">
		<result property="idPlaza" columnIndex="1"/>
		<result property="idServidor" columnIndex="2"/>
		<result property="fechaIni" columnIndex="3"/>
		<result property="fechaFin" columnIndex="4"/>
		<result property="idPlazaServidor" columnIndex="5"/>
		<result property="serCod" columnIndex="6"/>
		<result property="numSerest" columnIndex="7"/>
		<result property="n_resol_ing" columnIndex="8"/>
		<result property="n_id_pla_serv_est"	columnIndex="9"/>
		</resultMap>
		<!-- 	<resultMap id="dependenciamap" class="PlazaServidorDTO">
		<result property="idPlaza" columnIndex="N_ID_PLAZA"/>
		<result property="idServidor" columnIndex="N_ID_SERVIDOR"/>
		<result property="fechaIni" columnIndex="F_FECHA_INI"/>
		<result property="fechaFin" columnIndex="F_FECHA_FIN"/>
		<result property="idPlazaServidor" columnIndex="C_ID_PLAZA_SERVIDOR"/>
		<result property="serCod" columnIndex="T_SER_COD"/>
		<result property="numSerest" columnIndex="N_NUM_SEREST"/>
		
		</resultMap>-->
		
<insert id="insertPuestoTrab" parameterClass="PlazaServidorDTO">
INSERT INTO QPDATAGESTION.TB_PLAZA_SERVIDOR
VALUES(#idPlaza#,#idServidor#,#fechaIni#,#fechaFin#,(select nvl(max(C_ID_PLAZA_SERVIDOR), 0)+1 from QPDATAGESTION.TB_PLAZA_SERVIDOR),
#serCod#,#numSerest#,#n_resol_ing#,#n_id_pla_serv_est#)
</insert>
<delete id="deletePuestoTrab" parameterClass="java.lang.Integer">
DELETE QPDATAGESTION.TB_PLAZA_SERVIDOR WHERE C_ID_PLAZA_SERVIDOR=#idPlazaServidor#
</delete>
<select id="selectPuestoTrab" parameterClass="java.lang.Integer"
 resultMap="rsPlazaServ">
SELECT N_ID_PLAZA,N_ID_SERVIDOR,F_FECHA_INI, F_FECHA_FIN, C_ID_PLAZA_SERVIDOR, T_SER_COD, N_NUM_SEREST,N_RESOL_ING,N_ID_PLA_SERV_EST
FROM QPDATAGESTION.TB_PLAZA_SERVIDOR WHERE C_ID_PLAZA_SERVIDOR=#idPlazaServidor#
</select>

<select id="obtenerEstadosdePlazaServidor" parameterClass="java.lang.Integer" resultClass="pe.edu.unmsm.quipucamayoc.sgfqRRHH.negocio.dto.PlazaServidorEstadoDTO">
	select * from TB_PLAZA_SERVIDOR_ESTADO pse where pse.N_EST_PLAZA=#estadoPlaza# and pse.FK_PLA_SERV_EST is null
</select>

<delete id="deletePuestoTrabxPlaza" parameterClass="java.lang.Integer">
DELETE QPDATAGESTION.TB_PLAZA_SERVIDOR WHERE N_ID_PLAZA=#idPlaza#
</delete>

<update id="updatePuestoTrab" parameterClass="PlazaServidorDTO">
UPDATE QPDATAGESTION.TB_PLAZA_SERVIDOR
SET f_fecha_ini=#fechaIni#, f_fecha_fin=#fechaFin#, N_ID_PLAZA=#idPlaza#
WHERE C_ID_PLAZA_SERVIDOR=#idPlazaServidor#
</update>

<update id="updateFechaFin" parameterClass="java.util.Map">
UPDATE QPDATAGESTION.TB_PLAZA_SERVIDOR 
SET f_fecha_fin=#fechaFin#
WHERE N_ID_PLAZA=#idPlaza#
</update>
</sqlMap>
